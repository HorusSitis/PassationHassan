%\section{Ionic diffusion in porous media}
In this section, we present the method of periodic homogenization for the diffusion of ionic species in cementitious material.

\par
%%% à mettre dans le résumé éventuellement
Indeed, the life service of steel concrete is affected by the diffusion of ionic species, %
like chloride for constructions on the coasts or off-shore. %
Chloride penetrate the cementitious material, which is porous, and then deteriorates the steel structure, making the concrete fragile.

\subsection{Ionic species in saturated porous media : The Nernst-Planck-Poisson equation}

We consider a saturated porous medium $\Omega$, which consists into an solid phase $\Omega_s$ and a fluid phase $\Omega_f$.

\par
The following equations describe the dynamics, in the fluid phase $\Omega_f$, of the respective concentrations : $c_k$ , of a family of ionic species with index $k$ ; %
$z_k$ is the valence of ion $k$.

\begin{equation}\label{npp_f}
\left\{%
\begin{array}{lcl}
\dfrac{\partial{c_k}}{\partial{t}}&=&div\left(-D_k\left(grad(c_k)+\dfrac{F}{RT}grad(\Psi)\right)\right)\\
\epsilon_p \Delta \Psi&=&-\rho
\end{array}
\right.
\end{equation}

For the diffusion equations $D_k$ is the self-diffusion of ion $k$, $F$ and $R$ are the Faraday and perfect gas constants, $T$ the temperature ; %
for the Poisson equation $\Psi$ is the electrical potential, $\epsilon_v$ the dielectrical constant of the porous medium and $\rho$ the volumetric electrical charge.

\par
The above system is completed by the Neumann condition on $\Gamma_{sf}$ :

\begin{equation}\label{npp_sf}
\left\{%
\begin{array}{lcr}
D_k\left(grad(c_k)+\dfrac{F}{RT}grad(\Psi)\right)\cdot \vec{n}_{sf}&=&0\\
grad \Psi\cdot \vec{n}_{sf}&=&0
\end{array}
\right.
\end{equation}

In this model, we don't care about electrical interactions between the ions and the solid phase.

\ligneinter
The above system describe the dynamics of ionic concentrations in a medium with heterogeneities at a microscopic scale, %
and is far too big to be fully resolved numerically.

\par
Homogenization methods attempt to reformulate this problem by another one involving only macroscopic variables, %
\og{} blurring \fg{} microscopical heterogeneities.

\subsection{Periodic homogenization}

This method relies on the hypothesis that we can modelize a sample of porous medium, %
which in this section will be a square or a cube with side $L$, %
as the periodic repetition of a single elementary cell of size $l$. %
This elementary cell must summarize the geometrical properties of the structure so that this periodic model behaves like the physical medium we are working with.

\par
Examples of periodical microstructures can be found in \cite{WalMill16}, here we are working with the following periodical two- or three-dimensional microstructures.

\subsubsection{Two-dimensional structures}





\subsubsection{Three-dimensional structures}






\subsubsection{Homogenized equations}

The purpose of periodic homogenization is to derive an equation which describes our system evolution, here the concentration of a collection of chemical substances. %
The resulting problem must have a reasonable size so that we can do predictions using contemporary technology.

\par
A homogenized diffusion equation depends on time, and of a macroscopic variable $\mathbf{x}$ or $(x_1,\dots ,x_{dim})$ which lies in the two- or three-dimensional structure of size $L$, %
with space resolution $l$.

\par
Periodicity of the structure gives us two independent space variables : %
$\mathbf{x}$ which we have seen above, %
and $\mathbf{y}$, the generic position of a point in the elementary cell, which dosen't depend on $\mathbf{x}$ because the elemntary cell is the same for each localization in the macro-structure.

\par
In addition, we will will make two hypotheses for periodic homogenization :

\begin{itemize}
\item $\delta\ll l$ ;
\item $l\ll L$ ;
\end{itemize}

$\delta$ is the typical size of the medium constituents : grains of sand etc ; %
the last hypothesis is relevant for the asymptotical analysis that follows, %
from which we derive homogenized physical parameters.

\ligneinter
We find in \cite{th_khaledB} complete proofs about homogenization of Nernst-Planck-Poisson equations ; %
a few steps of the process is given below.

\par
Let us write :

\[\epsilon =\frac{l}{L}\]

For $\theta$ a given scalar physical quantity like a concentration or an electrical potential, we write the power series in the $\epsilon$ :

\begin{equation}\label{asyt}
\theta\left((\mathbf{x},\mathbf{y}),t\right)=\theta^0\left((\mathbf{x},\mathbf{y}),t\right)+\epsilon \theta^1\left((\mathbf{x},\mathbf{y}),t\right) +\epsilon^2 \theta^2\left((\mathbf{x},\mathbf{y}),t\right) \dots
\end{equation}

Moreover, if we set $\epsilon$ to zero, so that $\mathbf{y}$ is identically $\mathbf{0}$, %
$\theta$ equals its $\theta^0$ component of rank $0$ ; %
thus we can write $\theta(\mathbf{x},t$ as a function of the $\mathbf{x}$ and $t$.

\par
Therefore $\theta^0$ is a first example of homogenized quantity, as is depends only of a macrostopic variable.

\par
A dimensional analysis on the physical equations leads to replace spatial differential operators, like gradient and laplacian with %
$\epsilon\derp{}{\mathbf{x}}+\derp{}{\mathbf{y}}$ and $\epsilon^2\Delta_{\mathbf{x}}+2\epsilon \dfrac{\partial^2}{\partial{\mathbf{x}}\partial{\mathbf{y}}} +\Delta{\mathbf{y}}$ respectively.

\par
Then identification of small-order components of $\epsilon$ power series which we substitute in $\mathbf{x},\mathbf{y},t-$dependent equations gives us the homogenized system. %
For diffusion-migration of ions in porous media, we derive from Nernst-Planck-Poisson equations :

\begin{description}
\item[Homogenized equation :] %
\[\derp{c_k}{t}-div_{\mathbf{x}}\left(D_k^{hom}\derp{c_k}{\mathbf{x}}+D_k^{hom}\frac{F}{RT}z_k \derp{\Psi}{\mathbf{x}}\right)=0\]
\item[Homogenized tensor $D_k^{hom}$ :] 
\[D_k^{hom}:=\int\limits_{\Omega_f}\left(I+\derp{\chi}{\mathbf{y}}^T\right)\text{d}\Omega\]
\end{description}

depending on $\mathbf{x}$ and $t$, %
where $\chi$ is a function of $\mathbf{y}$, %
solution to the following problem.

\begin{comment}
\begin{rema}
In this paragraph we have skipped adimensionalization of the physical equations, which is prior to asymptotical analysis. %
Anyway, if doesn't change the general idea of the proof.
\end{rema}
\end{comment}

\begin{comment}
\ligneinter
A proof of these statements can be found in \cite{th_khaledB}, chapter 2.

\begin{rema}%%%à écrire dans le résumé, ou un paragraphe de conclusion ?
In this section, we focused on Nernst-Plank equation, which describes the diffusion of ionic species, like chloride, in the fluid domain of cementitious material.

\par
However the periodic homogenization method can be applied to other mechanisms of degradation of concrete structures : %
see section 2 of \cite{WalMill16} for a homogenized equation of moisture transport in cementitious material.

\par
Everything that we do in sections \ref{rom} and \ref{res} stays true in these contexts.
\end{rema}
\end{comment}
\begin{comment}
\subsubsection{Homogenized Richards Equation \cite{WalMill16}}

\begin{equation}\label{ric_wat}
\dfrac{\partial{\theta_l}}{\partial{t}}-div_x\left(\mathbf{D^{hom}_{\theta}}\dfrac{\partial{\theta_l}}{\partial{x}}\right)=0
\end{equation}

where $\theta_l$ is the water content : $\theta_l=\dfrac{\Omega_l}{\Omega}$ ; and

\[\mathbf{D^{hom}_{\theta}}=-\Lambda_{ll}\dfrac{\partial{P_c}}{\partial{\theta_l}}+\dfrac{1}{\rho_l}\mathbf{D^{hom}_{v}}\dfrac{\partial{\rho_v}}{\partial{\theta_l}}\]

denotes the homogenized diffusion tensor of moisture, $\rho_l$ and $\rho_v$ are liquid and vapour densities, respectively. $\Lambda_{ll}$ is the Darcy tensor of permeability, %
$P_c$ the macroscopic capillary pressure and $\mathbf{D^{hom}_{v}}$ the homogenized tensor of water vapour given by

\[\mathbf{D^{hom}_{v}}=\dfrac{1}{|\Omega|}\int\limits_{\Omega_{g}}D_v \left(I+\frac{\partial{\chi}}{\partial{y}}^{T}\right)\text{d}\Omega\]

where $D_v$ is the self-diffusion coefficient of water-vapour.

\par
The vector $\chi (y)$ is solution of the same system as for Nernst-Planck-Poisson equation, if we write $\Omega_g$ and $\Gamma_{gs}$ in place of $\Omega_f$ and $\Gamma_{sf}$.
\end{comment}

\subsection{An auxiliary problem : the vector field $\chi$}

%\subsubsection{}
This work is about numerical resolution of the following system, which defines the vector field $\chi$ :

%\newcommand{}
%Grad \chi
%\dfrac{\partial{\chi}}{\partial{y}}
\begin{description}
\item[Equation in the pores] 
\begin{equation}\label{chistr}
\left\{%
\begin{array}{lccr}
Div_y \left( \dfrac{\partial{\chi}}{\partial{y}}^T\right) &=& 0&\text{ on }\Omega_f \\
\dfrac{\partial{\chi}}{\partial{y}} \cdot n_{sf}&=&-n_{sf}&\text{ on }\Gamma_{sf}
\end{array}
\right.
%\chi\text{ in periodic}
\end{equation}
\item[Periodicity] $\chi$ is periodic on $\Gamma_{ff}$
\item[Mean value condition] $\langle\chi\rangle_{\Omega_f}=0$
\end{description}

As soon as $\chi$ will be computated, it is easy to derive $D_k^{hom}$.

\ligneinter
The same system is used in \cite{WalMill16} to compute a homogenized diffusion tensor, %
which appears in Richardson's equation modelizing moisture diffusion in cementarious media.

\subsection{Weak formulation of problem \ref{chistr}}

The weak formulation of the equation on $\Omega_{sf}$ is written :

\[\forall v \in V , \int\limits_{\Omega_{sf}}Div\left(\left(grad_y \chi\right)^{T}\right)\cdot v\text{d}\Omega=0\]

where $V$ is the space of test functions.

\par
Using the formula :

\[Div(A\cdot w)=Div(A)\cdot w+Tr(A\cdot w)\]

which is true for all $2-$tensor field $A$ et all vector field $w$, we obtain :

\[\forall v \in V , \int\limits_{\Omega_{sf}}Div\left(\left(grad_y \chi\right)^{T}\cdot v\right)\text{d}\Omega-%
\int\limits_{\Omega_f}Tr\left(\left(grad_y\chi\right)^T\cdot grad_y v\right)\text{d}\Omega=0\]

which gives, acccording to the divergence theorem :

\[\forall v \in V , \int\limits_{\Gamma_{sf}\cup\Gamma{ff}}\left(\left(grad_y \chi\right)^{T}\cdot v\right)\cdot n\text{d}s-%
\int\limits_{\Omega_f}Tr\left(\left(grad_y\chi\right)^T\cdot grad_y v\right)\text{d}\Omega=0\]

The Neumann condition in \ref{chistr} then implies :

\begin{equation}\label{chiw}
\forall v \in V , %
\int\limits_{\Omega_f}Tr\left(\left(grad_y\chi\right)^T\cdot grad_y v\right)\text{d}\Omega=%
-\int\limits_{\Gamma{sf}}n_{sf}\cdot v\text{d}s%
+\int\limits_{\Gamma{ff}}\left(\left(grad_y \chi\right)^{T}\cdot v\right)\cdot n_{ff}\text{d}s
\end{equation}

$\left(grad_y \chi\right)^{T}$ and $v$ are periodic, $n_{ff}$ is anti-periodic : %
in equation \ref{chiw} $\displaystyle\int\limits_{\Gamma{ff}}\left(\left(grad_y \chi\right)^{T}\cdot v\right)\cdot n_{ff}\text{d}s$ vanishes so we conclude :

\begin{equation}\label{chiwper}
\forall v \in V , %
\int\limits_{\Omega_f}Tr\left(\left(grad_y\chi\right)^T\cdot grad_y v\right)\text{d}\Omega=%
-\int\limits_{\Gamma{sf}}n_{sf}\cdot v\text{d}s
\end{equation}

which is, when combinated with the mean-value condition $\langle\chi\rangle_{\Omega_f}=0$, the weak formulation of \ref{chistr}.

\subsection{Solutions with FEniCS : examples of microstructures}

\subsubsection{The two-dimensional case}




%%%Maillages, raffinement : exemples, figures
\begin{figure}[H]
\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline
\subfloat[A single fluid domain]{\includegraphics[width=0.24\linewidth,height=3.2cm]{../Figures2D/mesh_fixe.png}}
&%\hfill
\subfloat[A solid centered inclusion]{\includegraphics[width=0.24\linewidth,height=3.2cm]{../Figures2D/mesh_r_per505025.png}}
&%\hfill
\subfloat[Four inclusions the vertices]{\includegraphics[width=0.24\linewidth,height=3.2cm]{../Figures2D/mesh_r_per0025.png}}
&%\hfill
\subfloat[One inclusion on both sides]{\includegraphics[width=0.24\linewidth,height=3.2cm]{../Figures2D/mesh_r_per05025.png}}
\\
\hline
\end{tabular}
\end{center}
\caption{Examples of meshes performed with FEniCS}
\label{2d_mesh}
\end{figure}




\subsubsection{The three-dimensional case}

Algorithms are the same as in the two-dimensional case, but we will see that CPU times is much biggers, %
even if the mesh resolution is reasonable.





%%%Inclusion au centre
%%%r de 0.05 à 0.40
%%%Dhom_k : 0.93455015305 ; 0.93455015305 ; 0.93455015305 ; 0.937713361944 ; 0.942352510417 ; 0.94383619236 ; 0.941721377617






\subsection{Performances with Finite Element Method}

$\chi$, and thus the homogenized diffusion tensor $D_k^{hom}$, depends highly of the geometry of the microstructure of the the porous medium. %
Moreover, the CPU time for the resolution of the weak problem with Finite Element Method can be considerable, especially in the three-dimensional case, %
as the following table shows us.

%%%Table : temps CPU pour le calcul de \chi en 2-3D, préciser la résolution du maillage.


















