%\subsection{Three-dimensional case}

Following geometries, especially when the number of nodes in the mesh where Finite Element vector space is defined, fully justify the use of a Reduced Order Model, %
sice time of execution of the Finite Element Method becomes significant.

\par
Like in section \ref{hom_d}, we have chosen three different resolutions of the meshes used for each problem to solve with a ROM. %
These are defined by the number of nodes : $10$, $20$ or $50$, we find on a side of the unit cube.

\par
The following table gives the values of $N_{rom}$ with a threshold of $99,99\%$. We can see that, for a same problem in $\chi (\rho ,\mathbf{y})$, %
$N_{rom}$ depends on the size of the mesh : %
this can be understood mathematically since it has been defined, and calculated, from a Finite Element space. %
The latter is nothing more than an approximation of $L^2$ or $H^1$ we use for our physical problem.

\par
Therefore the physically relevant $N_{rom}$, which might be equal to the mathematical $N_{rom}$ for $L^2$ or $H^1$ functional space, %
is likely to be different of the values we find in the following table, %
and we can reasonably thik it will be lesser than its value for the biggest mesh.

\par
For example, $N_{rom}$ for a physical, spherical inclusion will be lesser than $3$, and lesser than $2$ for two spheres per unit cell.

\par
We should consider this issue since $N_{rom}$ may not be too small, if we want ROM to be relevant. %
Indeed, the trivial case when $N_{rom}$ equals $1$ leads us to choose, according to POD's definition, %
the mean value the interpolated $\chi '(,\rho_j)$ for the single POD vector.

\par
Hence resolution of the optimisation problem, directly or with method of snapshots, would be no longer useful.

{\renewcommand{\tabularxcolumn}[1]{%
>{\centering\arraybackslash}m{#1}}

\begin{figure}[H]
%
\begin{center}
%\begin{tabular}{|l||*{5}{c|}}
\begin{tabularx}{0.9\linewidth}%
{|>{\bfseries}c||%
*{3}{c|}%
*{2}{>{\centering \arraybackslash}X|}}
%
\hline
\rowcolor{lightgray} %
Res.%\backslashbox{Res.}{Config.}%
&Single sphere&Single cylinder&Two spheres&%
One sphere, one cylinder, $\rho=$ sphere radius&One sphere, one cylinder, $\rho=$ cylinder radius\\
%
\hline
\hline
10&5&5&4&4&5\\ \hline
20&4&5&3&3&4\\ \hline
50&3&5&2&2&4\\ \hline
\end{tabularx}
\end{center}
%
\caption{Values of $N_{rom}^{99,99\%}$, against the numer of nodes per unit segment}
\end{figure}

\ligneinter
In we following, we give results and perforlance of the method for two different resolutions : %
$20$ and $50$ nodes per unit segment, %
which mean respectively steps of $0.05$ and $0.02$ for the Finite Element spaces.

\par
The case of a step of $0.1$ gives results that are close to those from meshes with step $0.05$ and is therfore irrelevant for discussion on effociency of the method.

\par
However we kept values found for $N_{rom}^{99,99\%}$ to see its evolution with respect to the number of nodes.

\subsubsection{A single spherical inclusion}

\begin{figure}[H]%[!p]
%
\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_1_sur8sph_un_rayres20.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_2_sur8sph_un_rayres20.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_3_sur8sph_un_rayres20.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_4_sur8sph_un_rayres20.png}%
\\
\hline
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_5_sur8sph_un_rayres20.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_6_sur8sph_un_rayres20.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_7_sur8sph_un_rayres20.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_8_sur8sph_un_rayres20.png}%
\\
\hline
\end{tabular}
\end{center}
\caption{Resolution : $20$\ ; $8$ training solutions}
%
\end{figure}

\begin{figure}[H]
\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/snap_interpam_1_sur8sph_un_rayres20.png}%snap_interpam_6_sur8sph_un_rayres20.png
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/snap_interpam_2_sur8sph_un_rayres20.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/snap_interpam_3_sur8sph_un_rayres20.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/snap_interpam_4_sur8sph_un_rayres20.png}%
\\
\hline
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/snap_interpam_5_sur8sph_un_rayres20.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/snap_interpam_6_sur8sph_un_rayres20.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/snap_interpam_7_sur8sph_un_rayres20.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/snap_interpam_8_sur8sph_un_rayres20.png}%
\\
\hline
\end{tabular}
\end{center}
\caption{Resolution : $20$\ ; extrapolated snapshots}
\end{figure}

\begin{figure}[H]
\begin{center}
\begin{tabular}{|c|c|}
\hline
\includegraphics[width=0.4\linewidth, height=3cm]{../Figures3D/ener_vp_sph_un_ray_res20.png}
&%
\includegraphics[width=0.4\linewidth, height=3cm]{../Figures3D/ener_cumul_vp_sph_un_ray_res20.png}
\\ \hline
\end{tabular}
\end{center}
\caption{Energy of POD modes : $N_{rom}^{99,99\%}=4$}
\end{figure}

\begin{figure}[H]%<+->
%
\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/phi_1_sph_un_ray_res20.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/phi_2_sph_un_ray_res20.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/phi_3_sph_un_ray_res20.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/phi_4_sph_un_ray_res20.png}%
\\
\hline
\end{tabular}
\end{center}
%
\caption{Truncated POD basis on $\Omega_{fluid}^0$ : the unit cube}
\end{figure}
%%

\begin{figure}[H]%<+->
%
\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom11_sur8sph_un_rayres20.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom22_sur8sph_un_rayres20.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom33_sur8sph_un_rayres20.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom44_sur8sph_un_rayres20.png}%
\\
\hline
\end{tabular}
\end{center}
%
\caption{Solution with reduced order model on $\Omega_{fluid}^{new}$ : $20$ nodes per unit segment}
\end{figure}

\begin{figure}[H]%{Results}
%
\begin{center}
\begin{tabular}{|c|c||c|c||c|c||c|c||c||c|}
\hline
\rowcolor{lightgray} $\rho^{new}$&Porosity&${D_k^{hom,ROM}}_{11}$&${D_k^{hom,FEM}}_{11}$&Meshing&$Err$&$\phi_i^{new}$&ROM&FEM&Nodes\\
\hline
0,11&0,9944&0,9921&0,9918&2.24s&0,024\%&53.27s&2.92s&19.96s&136\ 002\\
\hline
0,22&0,9554&0,93498&0,93495&1.77s&0,034\%&48.35s&1.86s&19.64s&126\ 192\\
\hline
0,33&0,8495&0,79023&0,79020&1.87s&0,0027\%&45.70s&1.85s&19.48s&120\ 318\\
\hline
0,44&0,6432&0,53997&0,53989&1.88s&0,0139\%&35.63s&1.68s&13.53s&96\ 503\\
\hline
\end{tabular}
\end{center}
\caption{Resolution : $20$\ ; $N_{rom}=4$}
%
\end{figure}

\ligneinter
The same thing can be done for $50$ nodes per side of the cube :

\begin{figure}[H]%[!p]
%
\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_1_sur8sph_un_rayres50.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_2_sur8sph_un_rayres50.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_3_sur8sph_un_rayres50.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_4_sur8sph_un_rayres50.png}%
\\
\hline
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_5_sur8sph_un_rayres50.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_6_sur8sph_un_rayres50.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_7_sur8sph_un_rayres50.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_8_sur8sph_un_rayres50.png}%
\\
\hline
\end{tabular}
\end{center}
\caption{$8$ training solutions}
%
\end{figure}

\begin{figure}[H]
\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/snap_interpam_1_sur8sph_un_rayres50.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/snap_interpam_2_sur8sph_un_rayres50.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/snap_interpam_3_sur8sph_un_rayres50.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/snap_interpam_4_sur8sph_un_rayres50.png}%
\\
\hline
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/snap_interpam_5_sur8sph_un_rayres50.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/snap_interpam_6_sur8sph_un_rayres50.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/snap_interpam_7_sur8sph_un_rayres50.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/snap_interpam_8_sur8sph_un_rayres50.png}%
\\
\hline
\end{tabular}
\end{center}
\caption{Resolution : $50$\ ; extrapolated snapshots}
\end{figure}

\begin{figure}[H]
\begin{center}
\begin{tabular}{|c|c|}
\hline
\includegraphics[width=0.4\linewidth, height=3cm]{../Figures3D/ener_vp_sph_un_ray_res50.png}
&%
\includegraphics[width=0.4\linewidth, height=3cm]{../Figures3D/ener_cumul_vp_sph_un_ray_res50.png}
\\ \hline
\end{tabular}
\end{center}
\caption{Energy of POD modes : $N_{rom}^{99,99\%}=3$}
\end{figure}

\begin{figure}[H]%<+->
%
\begin{center}
\begin{tabular}{|c|c|c|}
\hline
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/phi_1_sph_un_ray_res50.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/phi_2_sph_un_ray_res50.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/phi_3_sph_un_ray_res50.png}%
\\
\hline
\end{tabular}
\end{center}
%
\caption{Truncated POD basis on $\Omega_{fluid}^0$ : the unit cube}
\end{figure}
%%

\begin{figure}[H]%<+->
%
\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom11_sur8sph_un_rayres50.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom22_sur8sph_un_rayres50.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom33_sur8sph_un_rayres50.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom44_sur8sph_un_rayres50.png}%
\\
\hline
\end{tabular}
\end{center}
%
\caption{Solution with reduced order model on $\Omega_{fluid}^{new}$ : $50$ nodes per unit segment}
\end{figure}

\begin{figure}[H]%{Results}
%
\begin{center}
\begin{tabular}{|c|c||c|c||c|c||c|c||c||c|}
\hline
\rowcolor{lightgray} $\rho^{new}$&Porosity&${D_k^{hom,ROM}}_{11}$&${D_k^{hom,FEM}}_{11}$&Meshing&$Err$&$\phi_i^{new}$&ROM&FEM&Nodes\\
\hline
\rowcolor{yellow} 0,11&0,99442&0,99193&0,99170&20.89s&0,0242\%&586.03s&14.29s&3300.58s&1\ 910\ 451\\
\hline
\rowcolor{yellow} 0,22&0,95540&0,93465&0,93462&20.30s&0,0030\%&551.64s&13.40s&4070.04s&1\ 784\ 718\\
\hline
\rowcolor{yellow} 0,33&0,849467&0,789899&0,789897&20.41s&0,00018\%&511.61s&12.71s&1061.76s&1\ 708\ 464\\
\hline
0,44&0,64318&0,53969&0,53967&18.03s&0,0032\%&385.18s&10.81s&229.80s&1\ 313\ 223\\
\hline
\end{tabular}
\end{center}
\caption{Resolution : $50$\ ; $N_{rom}=3$}
%
\end{figure}

\ligneinter
In purpose of evaluating the ROM method, we derive from above results the ratio $\mathcal{R}_{ROM}^{99,99\%}$ :

\begin{equation}
\label{eval_rom}
\mathcal{R}_{ROM}^{99,99\%}=\dfrac{t_{\phi^{new}}+t_{ROM}+t_{\text{Meshing}}}{t_{FEM}+t_{\text{Meshing}}}
\end{equation}

Since we can see that the main contribution to $\mathcal{R}_{ROM}^{99,99\%}$ will be the time of interpolation $t_{\phi^{new}}$, %
we also evaluate the folowing contribution to $\mathcal{R}_{ROM}^{99,99\%}$ :

\begin{equation}
\label{eval_interp}
\mathcal{R}_{interpol}^{99,99\%}=\dfrac{t_{\phi^{new}}}{t_{FEM}+t_{\text{Meshing}}}
\end{equation}

The results we have found in case of a single spherical inclusion for each elementary cell, for $20$ and $50$ nodes on each side of the cube, give the folllowing tables :

\begin{figure}[H]%{Results}
%
\begin{table}[H]
\begin{center}
%
\subfloat[res20sph_unR][Resolution : $20$\ ; $N_{rom}=4$]{%
\begin{tabular}{|c||c|c|c||c|}
\hline
\rowcolor{lightgray} $\rho^{new}$&$\mathcal{R}_{ROM}^{99,99\%}$&$\mathcal{R}_{interpol}^{99,99\%}$&Difference&Nodes\\
\hline
0,11&2.57&2.38&0.18&136\ 002\\
\hline
0,22&2.47&2.30&0.17&126\ 192\\
\hline
0,33&2.38&2.20&0.18&120\ 318\\
\hline
0,44&2.51&2.28&0.23&96\ 503\\
\hline
\end{tabular}%
}%
\qquad
\subfloat[res50sph_unR][Resolution : $50$\ ; $N_{rom}=3$]{%
\begin{tabular}{|c||c|c|c||c|}
\hline
\rowcolor{lightgray} $\rho^{new}$&$\mathcal{R}_{ROM}^{99,99\%}$&$\mathcal{R}_{interpol}^{99,99\%}$&Difference&Nodes\\
\hline
\rowcolor{yellow} 0,11&0.19&0.18&0.01&1\ 910\ 451\\
\hline
\rowcolor{yellow} 0,22&0.14&0.13&0.01&1\ 784\ 718\\
\hline
\rowcolor{yellow} 0,33&0.50&0.47&0.03&1\ 708\ 464\\
\hline
0,44&1.67&1.55&0.11&1\ 313\ 223\\
\hline
\end{tabular}%
}%
%
\end{center}
\end{table}
%
\caption{Evaluation of the method : a single spherical inclusion}
\end{figure}

\etoile
\newlength{\currentparskip}
\setlength{\currentparskip}{\parskip}
\begin{minipage}{\linewidth}
\setlength{\parskip}{\currentparskip}
Sice ratio $\mathcal{R}_{ROM}^{99,99\%}$ is greater than $1$ for the smallest resolution, %
the method isn't workable for this configuration.

\par
Nevertheless in most cases, but not all of them, the method is efficient for $50$ nodes per side of the cube.

\par
We can also see that the main contribution to this excessive time of execution is the interpolation, which isn't propely a step of POD. %
It is necessary since the space in which lies the vector field $\chi(\rho,\mathbf{y})$ depends on the parameter $\rho$ of the POD : %
this is a feature of our particular problem, and we must overcome this issue in a way specific to homogenization.

\par
Notice that :

\begin{enumerate}[label=(interp \roman*)]
\item Time $t_{\phi^{new}}$ depends on the nomber of modes we keep : %
a threshold of $99,99\%$ is excessive, since FEM used in the training step of the method gives us, %
in case of $20$ nodes per side of the cube, $D_{hom}$ with a precision of $10^{-3}$ ;
%
\item Interoplation is parallelisable :
\begin{description}
\item [With respect to $i$ :] Each thread interpolates one POD mode : time of execution becomes $\max\limits_{i\in 1\dots N_{rom}}t_{\phi_i}$ ;
\item [Across each $\phi_i$ :] Interpolation of a continuous function can be done in a finite set of subdomains of the arrival space : %
time of execution is divided by the number of threads.
\end{description}
\item Although it is not fully proven mathematically, we have found a way to compute the vector field $\chi$, and the homogenized tensor $D^{hom}$ with a great precision : %
there must exist a formalism in which our problem fully lies.
\end{enumerate}
\end{minipage}

%\ligneinter
%In the following, we use the POD-interpolation method for FE spaces with a higher number of nodes, %
%then we discuss its efficiency.

In the following, we give the same results for the geometries seen in section \ref{hom_d}.

\subsubsection{A single cylinder}

\begin{figure}[H]%<+->
%
\begin{center}
\subfloat[Solution with reduced order model on $\Omega_{fluid}^{new}$]{%
%\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom11_sur8cyl_un_rayres20.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom22_sur8cyl_un_rayres20.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom33_sur8cyl_un_rayres20.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom44_sur8cyl_un_rayres20.png}%
\\
\hline
\end{tabular}
%\end{center}
}%
%

%
\subfloat[Resolution : $20$\ ; $N_{rom}=5$]{%
%\begin{center}
\begin{tabular}{|c|c||c|c||c|c||c|c||c||c|}
\hline
\rowcolor{lightgray} $\rho^{new}$&Porosity&${D_k^{hom,ROM}}_{11}$&${D_k^{hom,FEM}}_{11}$&Meshing&$Err$&$\phi_i^{new}$&ROM&FEM&Nodes\\
\hline
0,11&0,96199&0,92874&0,92770&2.24s&0,1116\%&66.12s&2.10s&102.12s&132\ 963\\
\hline
0,22&0,84795&0,73657&0,73661&1.68s&0,0056\%&55.50s&1.94s&17.41s&114\ 534\\
\hline
0,33&0,65789&0,48873&0,48874&1.60s&0,0029\%&45.79s&1.83s&13.29s&97\ 029\\
\hline
0,44&0,39179&0,22272&0,22260&1.38s&0,0523\%&30.74s&1.58s&8.62s&69\ 612\\
\hline
\end{tabular}
%\end{center}
%\caption{Resolution : $20$\ ; $N_{rom}=5$}
%
}
\end{center}
\caption{Results of ROM with interpolation}
\end{figure}

\begin{figure}[H]%<+->
%
\begin{center}
%
\subfloat[Solution with reduced order model on $\Omega_{fluid}^{new}$]{%
\begin{tabular}{|c|c|c|c|}
\hline
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom11_sur8cyl_un_rayres50.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom22_sur8cyl_un_rayres50.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom33_sur8cyl_un_rayres50.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom44_sur8cyl_un_rayres50.png}%
\\
\hline
\end{tabular}
%
%\caption{Solution with reduced order model on $\Omega_{fluid}^{new}$ : $50$ nodes per unit segment}
}%
%

\subfloat[Resolution : $50$\ ; $N_{rom}=5$]{%
\begin{tabular}{|c|c||c|c||c|c||c|c||c||c|}
\hline
\rowcolor{lightgray} $\rho^{new}$&Porosity&${D_k^{hom,ROM}}_{11}$&${D_k^{hom,FEM}}_{11}$&Meshing&$Err$&$\phi_i^{new}$&ROM&FEM&Nodes\\
\hline
\rowcolor{yellow} 0,11&0,96199&0,92734&0,92691&20.51s&0,0464\%&959.15s&19.52s&1239.23s&1\ 892\ 742\\
\hline
0,22&0,84795&0,736090&0,736086&18.80s&0,0005\%&829.28s&17.22s&801.12s&1\ 644\ 420\\
\hline
0,33&0,65788&0,48861&0,48860&15.96s&0,0003\%&662.10s&14.28s&222.02s&1\ 331\ 142\\
\hline
0,44&0,39179&0,22267&0,22265&11.73s&0,0091\%&396.81s&9.23s&0.13s&833\ 502\\
\hline
\end{tabular}
}
%
\end{center}
\caption{Results of ROM with interpolation}
%
\end{figure}

\ligneinter

\begin{figure}[H]%{Results}
%
\begin{table}[H]
\begin{center}
%
\subfloat[res20cyl_unR][Resolution : $20$\ ; $N_{rom}=5$]{%
\begin{tabular}{|c||c|c|c||c|}
\hline
\rowcolor{lightgray} $\rho^{new}$&$\mathcal{R}_{ROM}^{99,99\%}$&$\mathcal{R}_{interpol}^{99,99\%}$&Difference&Nodes\\
\hline
0,11&0.68&0.63&0.04&132\ 963\\
\hline
0,22&3.10&2.91&0.19&114\ 534\\
\hline
0,33&3.31&3.07&0.23&97\ 029\\
\hline
0,44&3.37&3.07&0.30&69\ 612\\
\hline
\end{tabular}%
}%
\qquad
\subfloat[res50cyl_unR][Resolution : $50$\ ; $N_{rom}=5$]{%
\begin{tabular}{|c||c|c|c||c|}
\hline
\rowcolor{lightgray} $\rho^{new}$&$\mathcal{R}_{ROM}^{99,99\%}$&$\mathcal{R}_{interpol}^{99,99\%}$&Difference&Nodes\\
\hline
\rowcolor{yellow} 0,11&0.79&0.76&0.03&1\ 892\ 742\\
\hline
0,22&1.06&1.01&0.04&1\ 644\ 420\\
\hline
0,33&2.91&2.61&0.13&1\ 331\ 142\\
\hline
0,44&2.62&2.49&0.13&833\ 502\\
\hline
\end{tabular}%
}%
%
\end{center}
\end{table}
%
\caption{Evaluation of the method : a single cylinder inclusion}
\end{figure}

%\Floatbarrier
\subsubsection{Two spheres}

\begin{figure}[H]%<+->
%
\begin{center}
%
\subfloat[Solution with reduced order model on $\Omega_{fluid}^{new}$]{%
\begin{tabular}{|c|c|c|c|}
\hline
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom11_sur82sph_rayres20.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom22_sur82sph_rayres20.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom33_sur82sph_rayres20.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom44_sur82sph_rayres20.png}%
\\
\hline
\end{tabular}
}

\subfloat[Resolution : $20$\ ; $N_{rom}=3$]{%
\begin{tabular}{|c|c||c|c||c|c||c|c||c||c|}
\hline
\rowcolor{lightgray} $\rho^{new}$&Porosity&${D_k^{hom,ROM}}_{11}$&${D_k^{hom,FEM}}_{11}$&Meshing&$Err$&$\phi_i^{new}$&ROM&FEM&Nodes\\
\hline
0,11&0,98029&0,97370&0,97367&2.36s&0,0024\%&43.00s&2.18s&21.18s&143\ 322\\
\hline
0,22&0,94126&0,93500&0,93503&1.88s&0,0033\%&40.09s&2.11s&21.38s&134\ 229\\
\hline
0,33&0,83533&0,83002&0,83009&1.94s&0,0093\%&36.27s&2.03s&17.50s&125\ 094\\
\hline
0,44&0,62904&0,62589&0,62591&1.95s&0,0036\%&28.85s&1.84s&15.55s&100\ 767\\
\hline
\end{tabular}
}
%
%\caption{Resolution : $20$\ ; $N_{rom}=3$}
%
\end{center}
%
\caption{Results of ROM with interpolation}
\end{figure}

\begin{figure}[H]
%
\begin{center}
%
\subfloat[Solution with reduced order model on $\Omega_{fluid}^{new}$]{%
\begin{tabular}{|c|c|c|c|}
\hline
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom11_sur82sph_rayres50.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom22_sur82sph_rayres50.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom33_sur82sph_rayres50.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom44_sur82sph_rayres50.png}%
\\
\hline
\end{tabular}
}
%

\subfloat[Resolution : $50$\ ; $N_{rom}=2$]{%
\begin{tabular}{|c|c||c|c||c|c||c|c||c||c|}
\hline
\rowcolor{lightgray} $\rho^{new}$&Porosity&${D_k^{hom,ROM}}_{11}$&${D_k^{hom,FEM}}_{11}$&Meshing&$Err$&$\phi_i^{new}$&ROM&FEM&Nodes\\
\hline
\rowcolor{yellow} 0,11&0,98029&0,97353&0,97347&20.40s&0,0064\%&373.63s&18.42s&951.97s&1\ 841\ 469\\
\hline
\rowcolor{yellow} 0,22&0,94126&0,93479&0,94394&20.88s&0,0048\%&353.76s&17.89s&1098.30s&1\ 736\ 505\\
\hline
\rowcolor{yellow} 0,33&0,83533&0,82986&0,82994&20.40s&0,0091\%&335.76s&18.44s&803.21s&1\ 671\ 780\\
\hline
0,44&0,62904&0,62574&0,62582&17.73s&0,0131\%&256.65s&14.12s&224.55s&1\ 294\ 941\\
\hline
\end{tabular}
}
%
\end{center}
\caption{Results of ROM with interpolation}
%
\end{figure}

\ligneinter
\begin{figure}[H]%{Results}
%
\begin{table}[H]
\begin{center}
%
\subfloat[res202sphR][Resolution : $20$\ ; $N_{rom}=3$]{%
\begin{tabular}{|c||c|c|c||c|}
\hline
\rowcolor{lightgray} $\rho^{new}$&$\mathcal{R}_{ROM}^{99,99\%}$&$\mathcal{R}_{interpol}^{99,99\%}$&Difference&Nodes\\
\hline
0,11&1.99&1.80&0.19&143\ 322\\
\hline
0,22&1.90&1.73&0.17&134\ 229\\
\hline
0,33&2.07&1.87&0.20&125\ 094\\
\hline
0,44&1.87&1.65&0.22&100\ 767\\
\hline
\end{tabular}%
}%
\qquad
\subfloat[res502sphR][Resolution : $50$\ ; $N_{rom}=2$]{%
\begin{tabular}{|c||c|c|c||c|}
\hline
\rowcolor{lightgray} $\rho^{new}$&$\mathcal{R}_{ROM}^{99,99\%}$&$\mathcal{R}_{interpol}^{99,99\%}$&Difference&Nodes\\
\hline
\rowcolor{yellow} 0,11&0.42&0.38&0.04&1\ 841\ 469\\
\hline
\rowcolor{yellow} 0,22&0.35&0.32&0.03&1\ 736\ 505\\
\hline
\rowcolor{yellow} 0,33&0.45&0.40&0.05&1\ 671\ 780\\
\hline
0,44&1.19&1.06&0.13&1\ 294\ 941\\
\hline
\end{tabular}%
}%
%
\end{center}
\end{table}
%
\caption{Evaluation of the method : two spheres}
\end{figure}

\subsubsection{One sphere and one cylinder : $\rho$ is the radius of the sphere}

\begin{figure}[H]%<+->
%
\begin{center}
%
\subfloat[Solution with reduced order model on $\Omega_{fluid}^{new}$]{%
\begin{tabular}{|c|c|c|c|}
\hline
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom11_sur8cylsph_ray_sphres20.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom22_sur8cylsph_ray_sphres20.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom33_sur8cylsph_ray_sphres20.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom44_sur8cylsph_ray_sphres20.png}%
\\
\hline
\end{tabular}
}
%

%
\subfloat[Resolution : $20$\ ; $N_{rom}=3$]{%
\begin{tabular}{|c|c||c|c||c|c||c|c||c||c|}
\hline
\rowcolor{lightgray} $\rho^{new}$&Porosity&${D_k^{hom,ROM}}_{11}$&${D_k^{hom,FEM}}_{11}$&Meshing&$Err$&$\phi_i^{new}$&ROM&FEM&Nodes\\
\hline
0,11&0,98029&0,863876&0,86358&2.28s&0,0204\%&40.23s&2.06s&19.16s&132\ 900\\
\hline
0,22&0,94126&0,82761&0,82797&1.79s&0,0433\%&36.09s&2.01s&18.26s&121\ 956\\
\hline
0,33&0,0.77878&0,73056&0,73060&1.95s&0,0047\%&33.47s&1.93s&15.24s&116\ 355\\
\hline
0,44&0,57250&0,54089&0,540046&1.89s&0,1554\%&25.41s&1.77s&13.28s&92\ 058\\
\hline
\end{tabular}
}
%
\end{center}
%
\caption{Results of ROM with interpolation}
\end{figure}

\begin{figure}[H]%<+->
%
\begin{center}
%
\subfloat[Solution with reduced order model on $\Omega_{fluid}^{new}$]{%
\begin{tabular}{|c|c|c|c|}
\hline
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom11_sur8cylsph_ray_sphres50.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom22_sur8cylsph_ray_sphres50.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom33_sur8cylsph_ray_sphres50.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom44_sur8cylsph_ray_sphres50.png}%
\\
\hline
\end{tabular}
}
%

\subfloat[Resolution : $50$\ ; $N_{rom}=2$]{%
\begin{tabular}{|c|c||c|c||c|c||c|c||c||c|}
\hline
\rowcolor{lightgray} $\rho^{new}$&Porosity&${D_k^{hom,ROM}}_{11}$&${D_k^{hom,FEM}}_{11}$&Meshing&$Err$&$\phi_i^{new}$&ROM&FEM&Nodes\\
\hline
\rowcolor{yellow} 0,11&0,92374&0,86362&0,86301&18.54s&0,0709\%&341.82s&17.17s&930.87s&1\ 673\ 688\\
\hline
\rowcolor{yellow} 0,22&0,88471&0,82716&0,82747&18.79s&0,0369\%&325.36s&15.93s&791.92s&1\ 630\ 377\\
\hline
\rowcolor{yellow} 0,33&0,77878&0,729139&0,730195&18.47s&0,1446\%&300.91s&15.21s&1722.75s&1\ 518\ 327\\
\hline
0,44&0,57250&0,542528&0,539777&16.6s&0,5096\%&229.21s&12.2s&143.36s&1\ 167\ 783\\
\hline
\end{tabular}
}
%
\end{center}
%
\caption{Results of ROM with interpolation}
\end{figure}

\ligneinter

\begin{figure}[H]%{Results}
%
\begin{table}[H]
\begin{center}
%
\subfloat[res20cylsph_rsR][Resolution : $20$\ ; $N_{rom}=3$]{%
\begin{tabular}{|c||c|c|c||c|}
\hline
\rowcolor{lightgray} $\rho^{new}$&$\mathcal{R}_{ROM}^{99,99\%}$&$\mathcal{R}_{interpol}^{99,99\%}$&Difference&Nodes\\
\hline
0,11&2.08&1.88&0.20&132\ 900\\
\hline
0,22&1.99&1.80&0.18&121\ 956\\
\hline
0,33&2.13&1.91&0.22&116\ 355\\
\hline
0,44&1.92&1.67&0.24&92\ 058\\
\hline
\end{tabular}%
}%
\qquad
\subfloat[res50cylsph_rsR][Resolution : $50$\ ; $N_{rom}=2$]{%
\begin{tabular}{|c||c|c|c||c|}
\hline
\rowcolor{lightgray} $\rho^{new}$&$\mathcal{R}_{ROM}^{99,99\%}$&$\mathcal{R}_{interpol}^{99,99\%}$&Difference&Nodes\\
\hline
\rowcolor{yellow} 0,11&0.40&0.36&0.04&1\ 673\ 688\\
\hline
\rowcolor{yellow} 0,22&0.44&0.40&0.04&1\ 630\ 377\\
\hline
\rowcolor{yellow} 0,33&0.19&0.17&0.02&1\ 518\ 327\\
\hline
0,44&1.61&1.43&0.18&1\ 167\ 783\\
\hline
\end{tabular}%
}%
%
\end{center}
\end{table}
%
\caption{Evaluation of the method : one sphere and one cylinder, $\rho$ is the radius of the sphere}
\end{figure}

\subsubsection{One sphere and one cylinder : $\rho$ is the radius of the cylinder}

\begin{figure}[H]%<+->
%
\begin{center}
%
\subfloat[Solution with reduced order model on $\Omega_{fluid}^{new}$]{%
\begin{tabular}{|c|c|c|c|}
\hline
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom11_sur8cylsph_ray_cylres20.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom22_sur8cylsph_ray_cylres20.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom33_sur8cylsph_ray_cylres20.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom44_sur8cylsph_ray_cylres20.png}%
\\
\hline
\end{tabular}
}
%

\subfloat[Resolution : $20$\ ; $N_{rom}=4$]{%
\begin{tabular}{|c|c||c|c||c|c||c|c||c||c|}
\hline
\rowcolor{lightgray} $\rho^{new}$&Porosity&${D_k^{hom,ROM}}_{11}$&${D_k^{hom,FEM}}_{11}$&Meshing&$Err$&$\phi_i^{new}$&ROM&FEM&Nodes\\
\hline
0,11&0,94785&0,91523&0,91425&2.78s&0,1068\%&54.51s&2.25s&19.86s&138\ 420\\
\hline
0,22&0,83381&0,72475&0,72472&1.74s&0,0041\%&47.22s&2.23s&17.76s&120\ 540\\
\hline
0,33&0,64374&0,47863&0,47869&1.58s&0,0085\%&36.70s&1.75s&12.83s&98\ 262\\
\hline
0,44&0,37765&0,21372&0,21368&1.35s&0,0193\%&21.90s&1.48s&6.84s&62\ 127\\
\hline
\end{tabular}
}
%
\end{center}
%
\caption{Results of ROM with interpolation}%
\end{figure}

\begin{figure}[H]%<+->
%
\begin{center}
%
\subfloat[Solution with reduced order model on $\Omega_{fluid}^{new}$]{%
\begin{tabular}{|c|c|c|c|}
\hline
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom11_sur8cylsph_ray_cylres50.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom22_sur8cylsph_ray_cylres50.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom33_sur8cylsph_ray_cylres50.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_rom44_sur8cylsph_ray_cylres50.png}%
\\
\hline
\end{tabular}
}
%

%
\subfloat[Resolution : $50$\ ; $N_{rom}=4$]{%
\begin{tabular}{|c|c||c|c||c|c||c|c||c||c|}
\hline
\rowcolor{lightgray} $\rho^{new}$&Porosity&${D_k^{hom,ROM}}_{11}$&${D_k^{hom,FEM}}_{11}$&Meshing&$Err$&$\phi_i^{new}$&ROM&FEM&Nodes\\
\hline
\rowcolor{yellow} 0,11&0,94785&0,91461&0,91351&19.78s&0,1207\%&729.03s&21.66s&3191.41s&1\ 813\ 602\\
\hline
\rowcolor{yellow} 0,22&0,83381&0,72436&0,72435&18.08s&0,0016\%&646.01s&19.46s&801.00s&1\ 605\ 630\\
\hline
0,33&0,64374&0,47860&0,47859&14.16s&0,0004\%&487.25s&14.78s&240.91s&1\ 200\ 282\\
\hline
0,44&0,37765&0,21391&0,21388&9.86s&0,0128\%&293.35s&9.21s&132.92s&754\ 662\\
\hline
\end{tabular}
}
%
\end{center}
%
\caption{Results of ROM with interpolation}
\end{figure}

\ligneinter

\begin{figure}[H]%{Results}
%
\begin{table}[H]
\begin{center}
%
\subfloat[res20cylsph_rcR][Resolution : $20$\ ; $N_{rom}=4$]{%
\begin{tabular}{|c||c|c|c||c|}
\hline
\rowcolor{lightgray} $\rho^{new}$&$\mathcal{R}_{ROM}^{99,99\%}$&$\mathcal{R}_{interpol}^{99,99\%}$&Difference&Nodes\\
\hline
0,11&2.63&2.42&0.20&120\ 540\\
\hline
0,22&2.63&2.42&0.20&120\ 240\\
\hline
0,33&2.78&2.55&0.23&98\ 262\\
\hline
0,44&3.02&2.67&0.35&62\ 127\\
\hline
\end{tabular}%
}%
\qquad
\subfloat[res50cylsph_rcR][Resolution : $50$\ ; $N_{rom}=4$]{%
\begin{tabular}{|c||c|c|c||c|}
\hline
\rowcolor{lightgray} $\rho^{new}$&$\mathcal{R}_{ROM}^{99,99\%}$&$\mathcal{R}_{interpol}^{99,99\%}$&Difference&Nodes\\
\hline
\rowcolor{yellow} 0,11&0.24&0.23&0.01&1\ 813\ 602\\
\hline
\rowcolor{yellow} 0,22&0.83&0.79&0.05&1\ 605\ 630\\
\hline
0,33&2.02&1.91&0.11&1\ 200\ 282\\
\hline
0,44&2.19&2.06&0.13&754\ 662\\
\hline
\end{tabular}%
}%
%
\end{center}
\end{table}
%
\caption{Evaluation of the method : one sphere and one cylinder, $\rho$ is the radius of the cylinder}
\end{figure}