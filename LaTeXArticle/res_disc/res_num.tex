\section{Results and discussion}\label{res}

\subsection{Material}

\begin{description}
\item [Machine] 1$\times$CPU 2.90GHz
\item [FEM] Resolution of the weak problem in $\chi$ was done with FEniCS, %
an open-source platform programmed in Python designed for Finite Element Method.
\item [ROM] The numpy package of python 3 was used for POD.
\end{description}

\subsection{Two-dimensional case : varying the radius of a single circular inclusion}

For all the two-dimensional cases, resolution is set to $100$ : %
100 nodes lie on each side of the unit square.

\par
For Finite Element Method, in the training step and for validation of the Reduced Order Model, we chose polynomial elements of degree $2$.

\subsubsection{Centered inclusion}

See section \ \ref{rom} for figures and choice of $N_{rom}$.
%\begin{comment}
\begin{figure}[H]%{Results}
%
\begin{center}
\begin{tabular}{|c|c||c|c||c|c||c||c|c||c||c|}
\hline
$\rho^{new}$&Porosity&${D_k^{hom,ROM}}_{11}$&${D_k^{hom,FEM}}_{11}$&Meshing&$Err$&$\phi_i^{new}$&ROM&FEM&Nodes\\
\hline
0,11&0,9620&0,9284&0,9268&1.84s&0,1753\%&2.25s&0.34s&10.64s&103090\\
\hline
0,22&0,8479&0,7362&0,7360&1.23s&0,0232\%&1.83s&0.45s&7.26s&90062\\
\hline
0,33&0,6579&0,488596&0,4488589&1.00s&0,0014\%&1.48s&0.31s&4.14s&70118\\
\hline
0,44&0,3918&0,2228&0,2227&0.85s&0,0702\%&1.00s&0.22s&1.48s&41458\\
\hline
\end{tabular}
\end{center}
\caption{$N_{rom}=2$}
%
\end{figure}

%$99,9 \% : N_{rom}=4$.
%\end{comment}
\subsubsection{Disc at vertices}

\begin{figure}[H]
\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline
\subfloat[$D_k^{hom}=0.9845$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/sol_1_sur8cer_un_som_ray.png}}%
&%
\subfloat[$D_k^{hom}=0.9391$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/sol_2_sur8cer_un_som_ray.png}}%
&%
\subfloat[$D_k^{hom}=0.8680$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/sol_3_sur8cer_un_som_ray.png}}%
&%
\subfloat[$D_k^{hom}=0.7767$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/sol_4_sur8cer_un_som_ray.png}}%
\\
\hline
\subfloat[$D_k^{hom}=0.6716$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/sol_5_sur8cer_un_som_ray.png}}%
&%
\subfloat[$D_k^{hom}=0.5585$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/sol_6_sur8cer_un_som_ray.png}}%
&%
\subfloat[$D_k^{hom}=0.4415$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/sol_7_sur8cer_un_som_ray.png}}%
&%
\subfloat[$D_k^{hom}=0.3221$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/sol_8_sur8cer_un_som_ray.png}}%
\\
\hline
\end{tabular}
\end{center}
\caption{The vector fields $\chi(\mathbf{x},\rho_j )$}
\end{figure}

\begin{figure}[H]
\begin{center}
\begin{tabular}{|c|c|}
\hline
\subfloat[$\phi_1$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/phi_1_compl_hor.png}}%
&%
\subfloat[$\phi_2$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/phi_2_compl_hor.png}}%
\\
\hline
\end{tabular}
\end{center}
\caption{The truncated POD basis}
\end{figure}

\begin{figure}[H]
\begin{center}
\begin{tabular}{|c|c|}
\hline
\includegraphics[width=0.4\linewidth, height=3cm]{../Figures2D/ener_vp_cer_un_som_ray.png}%_res100
&%
\includegraphics[width=0.4\linewidth, height=3cm]{../Figures2D/ener_cumul_vp_cer_un_som_ray.png}%_res10
\\ \hline
\end{tabular}
\end{center}
\caption{Energy of POD modes}
\end{figure}

\begin{multicols}{2}
Cumulated energy :

\columnbreak
\begin{itemize}
\item $99,9 \% : N_{rom}=1$ ;
\item $99,99 \% : N_{rom}=2$.
\end{itemize}
%
\end{multicols}

\begin{figure}[H]%{Results}
%
\begin{center}
\begin{tabular}{|c|c||c|c||c||c|c||c|c||c||c|}
\hline
$\rho^{new}$&Porosity&${D_k^{hom,ROM}}_{11}$&${D_k^{hom,FEM}}_{11}$&Meshing&$Err$&$\phi_i^{new}$&ROM&FEM&Nodes\\
\hline
0,11&0,9620&0,9285&0,9268&1.84s&0,03670.1852\%&2.13s&0.33s&11.71s&101902\\
\hline
0,22&0,8479&0,7362&0,7360&1.23s&0,0242\%&2.07s&0.35s&7.75s&91606\\
\hline
0,33&0,6579&0,488596&0,488589&1.02s&0,00143\%&1.49s&0.53s&3.99s&70518\\
\hline
0,44&0,3918&0,2228&0,2227&0.77s&0,0702\%&1.02s&0.21s&1.69s&43118\\
\hline
\end{tabular}
\end{center}
\caption{$N_{rom}=2$}
%
\end{figure}

Here again, time difference between using Reduced Order Model instead of Finite Element Method is sensitive, %
for small values of $\rho$ which is a decreasinf function of porosity.

\par
The difference of time ratio FEM/ROM will depend from the number of nodes, as we can see in following section about three-dimensional geometries. %
 
\subsubsection{Diagonal alignement}

\begin{figure}[H]
\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline
\subfloat[$D_k^{hom}=0.8595$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/sol_1_sur8compl_diag.png}}%
&%
\subfloat[$D_k^{hom}=0.8196$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/sol_2_sur8compl_diag.png}}%
&%
\subfloat[$D_k^{hom}=0.7658$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/sol_3_sur8compl_diag.png}}%
&%
\subfloat[$D_k^{hom}=0.6758$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/sol_4_sur8compl_diag.png}}%
\\
\hline
\subfloat[$D_k^{hom}=0.5819$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/sol_5_sur8compl_diag.png}}%
&%
\subfloat[$D_k^{hom}=0.4806$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/sol_6_sur8compl_diag.png}}%
&%
\subfloat[$D_k^{hom}=0.3762$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/sol_7_sur8compl_diag.png}}%
&%
\subfloat[$D_k^{hom}=0.2714$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/sol_8_sur8compl_diag.png}}%
\\
\hline
\end{tabular}
\end{center}
\caption{The vector fields $\chi(\mathbf{x},\rho_j )$}
\end{figure}

\begin{figure}[H]
\begin{center}
\begin{tabular}{|c|c|c|}
\hline
\subfloat[$\phi_1$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/phi_1_compl_diag.png}}%
&%
\subfloat[$\phi_2$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/phi_2_compl_diag.png}}%
&%
\subfloat[$\phi_3$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/phi_3_compl_diag.png}}%
\\
\hline
\end{tabular}
\end{center}
\caption{The truncated POD basis}
\end{figure}

\begin{figure}[H]
\begin{center}
\begin{tabular}{|c|c|}
\hline
\includegraphics[width=0.4\linewidth, height=3cm]{../Figures2D/ener_vp_compl_diag.png}%_res100
&%
\includegraphics[width=0.4\linewidth, height=3cm]{../Figures2D/ener_cumul_vp_compl_diag.png}%_res10
\\ \hline
\end{tabular}
\end{center}
\caption{Energy of POD modes}
\end{figure}

\begin{figure}[H]%{Results}
%
\begin{center}
\begin{tabular}{|c|c||c|c||c||c|c||c|c||c||c|}
\hline
$\rho^{new}$&Porosity&${D_k^{hom,ROM}}_{11}$&${D_k^{hom,FEM}}_{11}$&Meshing&$Err$&$\phi_i^{new}$&ROM&FEM&Nodes\\
\hline
0,11&0,8913&0,8090&0,8087&1.80s&0,0367\%&3.71s&1.09s&7.86s&96184\\
\hline
0,22&0,7773&0,6396&0,6395&1.24s&0,0195\%&2.95s&0.33s&5.45s&83020\\
\hline
0,33&0,5872&0,41807206&0,41807209&0.94s&6.44$\times 10^{-6}$\%&2.23s&0.30s&2.95s&23764\\
\hline
0,44&0,3211&0,1658769&0,1658763&0.77s&0,00033\%&1.58s&0.42s&1.77s&17054\\
\hline
\end{tabular}
\end{center}
\caption{$N_{rom}=3$}
%
\end{figure}

\subsubsection{Horizontal alignement}

\begin{figure}[H]
\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline
\subfloat[$D_k^{hom}=0.8582$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/sol_1_sur8compl_hor.png}}%
&%
\subfloat[$D_k^{hom}=0.8365$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/sol_2_sur8compl_hor.png}}%
&%
\subfloat[$D_k^{hom}=0.8028$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/sol_3_sur8compl_hor.png}}%
&%
\subfloat[$D_k^{hom}=0.7578$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/sol_4_sur8compl_hor.png}}%
\\
\hline
\subfloat[$D_k^{hom}=0.7020$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/sol_5_sur8compl_hor.png}}%
&%
\subfloat[$D_k^{hom}=0.6364$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/sol_6_sur8compl_hor.png}}%
&%
\subfloat[$D_k^{hom}=0.5619$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/sol_7_sur8compl_hor.png}}%
&%
\subfloat[$D_k^{hom}=0.4796$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/sol_8_sur8compl_hor.png}}%
\\
\hline
\end{tabular}
\end{center}
\caption{The vector fields $\chi(\mathbf{x},\rho_j )$}
\end{figure}


\begin{figure}[H]
\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline
\subfloat[$\phi_1$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/phi_1_compl_hor.png}}%
&%
\subfloat[$\phi_2$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/phi_2_compl_hor.png}}%
&%
\subfloat[$\phi_3$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/phi_3_compl_hor.png}}%
&%
\subfloat[$\phi_4$]{\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures2D/phi_4_compl_hor.png}}%
\\
\hline
\end{tabular}
\end{center}
\caption{The truncated POD basis}
\end{figure}

\begin{figure}[H]
\begin{center}
\begin{tabular}{|c|c|}
\hline
\includegraphics[width=0.4\linewidth, height=3cm]{../Figures2D/ener_vp_compl_hor.png}%_res100
&%
\includegraphics[width=0.4\linewidth, height=3cm]{../Figures2D/ener_cumul_vp_compl_hor.png}%_res10
\\ \hline
\end{tabular}
\end{center}
\caption{Energy of POD modes}
\end{figure}


\begin{figure}[H]%{Results}
%
\begin{center}
\begin{tabular}{|c|c||c|c||c||c|c||c|c||c||c|}
\hline
$\rho^{new}$&Porosity&${D_k^{hom,ROM}}_{11}$&${D_k^{hom,FEM}}_{11}$&Meshing&$Err$&$\phi_i^{new}$&ROM&FEM&Nodes\\
\hline
0,04&0,9243&0,8683&0,8618&1.98s&0,7592\%&4.03s&0.47s&9.52s&99784\\
\hline
0,10&0,8979&0,82924&0,82921&1.36s&0,00356\%&3.85s&0.46s&7.97s&96844\\
\hline
0,20&0,8037&0,71693&0,71694&1.21s&0,00079\%&3.92s&0.41s&5.66s&86184\\
\hline
0,30&0,6466&0,5414&0,5420&1.14s&0,1021\%&3.15s&0.38s&3.76s&68840\\
\hline
\end{tabular}
\end{center}
\caption{$N_{rom}=4$}
%
\end{figure}





%\Floatbarrier
\subsection{Three-dimensional case}

Following geometries, especially when the number of nodes in the mesh where Finite Element vector space is defined, fully justify the use of a Reduced Order Model, %
sice time of execution of the Finite Element Method becomes significant.

\subsubsection{A single spherical inclusion}

\begin{figure}[H]%[!p]
%
\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_1_sur8sph_un_rayres10.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_2_sur8sph_un_rayres10.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_3_sur8sph_un_rayres10.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_4_sur8sph_un_rayres10.png}%
\\
\hline
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_5_sur8sph_un_rayres10.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_6_sur8sph_un_rayres10.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_7_sur8sph_un_rayres10.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/sol_8_sur8sph_un_rayres10.png}%
\\
\hline
\end{tabular}
\end{center}
\caption{$8$ solutions of the physical problem}
%
\end{figure}

%\begin{itemize}
%\item $\rho^j$ is the radius of a sphere at the center of the cell.
%\item We interpolate the $\chi(\mathbf{y},\rho^j)$ on the unit cube minus $\mathcal{S}(\mathbf{0},0,0001)$.
%\end{itemize}

%\etoile

\begin{figure}[H]%<+->
%
\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/phi_1_sph_un_ray.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/phi_2_sph_un_ray.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/phi_3_sph_un_ray.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/phi_4_sph_un_ray.png}%
\\
\hline
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/phi_5_sph_un_ray.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/phi_6_sph_un_ray.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/phi_7_sph_un_ray.png}%
&%
\includegraphics[width=0.2\linewidth, height=2.2cm]{../Figures3D/phi_8_sph_un_ray.png}%
\\
\hline
\end{tabular}
\end{center}
%
\caption{The POD basis on $\Omega_{fluid}^0$ : the unit cube}
\end{figure}

\begin{figure}[H]
\begin{center}
\begin{tabular}{|c|c|}
\hline
\includegraphics[width=0.4\linewidth, height=3cm]{../Figures3D/ener_vp_sph_un_ray_res10.png}
&%
\includegraphics[width=0.4\linewidth, height=3cm]{../Figures3D/ener_cumul_vp_sph_un_ray_res10.png}
\\ \hline
\end{tabular}
\end{center}
\caption{Energy of POD modes}
\end{figure}

\begin{multicols}{2}
Cumulated energy :

\columnbreak
\begin{itemize}
\item $99,99\%$ : $N_{rom}=5$
\item $99,9\%$ : $N_{rom}=3$
\end{itemize}
%
\end{multicols}

\ligneinter

\begin{figure}[H]%{Results}
%
\begin{center}
\begin{tabular}{|c|c||c|c||c||c|c||c|c||c||c|}
\hline
$\rho^{new}$&Porosity&${D_k^{hom,ROM}}_{11}$&${D_k^{hom,FEM}}_{11}$&Meshing&$Err$&$\phi_i^{new}$&ROM&FEM&Nodes\\
\hline
0,22&0,9554&0,9360&0,9358&s&0,029\%&9.8s&1.1s&63.7s&19578\\
\hline
0,33&0,8495&0,7911&0,7910&s&0,013\%&9.4s&1.1s&67.8s&20043\\
\hline
0,44&0,6432&0,5406&0,5405&s&0,018\%&7.3s&1.0s&26.8s&16941\\
\hline
\end{tabular}
\end{center}
\caption{$N_{rom}=5$}
%
\end{figure}
%%

\subsubsection{A single cylinder}

\begin{figure}[H]
\begin{center}
\begin{tabular}{|c|c|}
\hline
\includegraphics[width=0.4\linewidth, height=3cm]{../Figures3D/ener_vp_cyl_un_ray_res10.png}
&%
\includegraphics[width=0.4\linewidth, height=3cm]{../Figures3D/ener_cumul_vp_cyl_un_ray_res10.png}
\\ \hline
\end{tabular}
\end{center}
\caption{Energy of POD modes}
\end{figure}

\begin{multicols}{2}
Cumulated energy :

\columnbreak
\begin{itemize}
\item $99,99\%$ : $N_{rom}=5$
\item $99,9\%$ : $N_{rom}=3$
\end{itemize}
%
\end{multicols}

\ligneinter

\begin{figure}[H]%{Results}
%
\begin{center}
\begin{tabular}{|c|c||c|c||c|c||c|c||c||c|}
\hline
$\rho^{new}$&Porosity&${D_k^{hom,ROM}}_{11}$&${D_k^{hom,FEM}}_{11}$&Meshing&$Err$&$\phi_i^{new}$&ROM&FEM&Nodes\\
\hline
0,22&0,8479&0,7390&0,7383&s&0,085\%&7.9s&1.1s&33.6s&16458\\
\hline
0,33&0,6579&0,4896&0,4893&s&0,049\%&6.6s&1.1s&21.1s&14868\\
\hline
0,44&0,3918&0,2228&0,2223&s&0,2099\%&5.96s&1.1s&10.5s&13923\\
\hline
\end{tabular}
\end{center}
\caption{$N_{rom}=5$}
%
\end{figure}
%%

%\Floatbarrier
\subsubsection{Two spheres}


\begin{figure}[H]
\begin{center}
\begin{tabular}{|c|c|}
\hline
\includegraphics[width=0.4\linewidth, height=3cm]{../Figures3D/ener_vp_2sph_ray_res10.png}
&%
\includegraphics[width=0.4\linewidth, height=3cm]{../Figures3D/ener_cumul_vp_2sph_ray_res10.png}
\\ \hline
\end{tabular}
\end{center}
\caption{Energy of POD modes}
\end{figure}

\begin{figure}[H]%{Results}
%
\begin{center}
\begin{tabular}{|c|c||c|c||c|c||c|c||c||c|}
\hline
$\rho^{new}$&Porosity&${D_k^{hom,ROM}}_{11}$&${D_k^{hom,FEM}}_{11}$&Meshing&$Err$&$\phi_i^{new}$&ROM&FEM&Nodes\\
\hline
0,11&0,&0,&0,&s&0,\%&s&s&s&\\
\hline
0,22&0,&0,&0,&s&0,\%&s&s&s&\\
\hline
0,33&0,&0,&0,&s&0,\%&s&s&s&\\
\hline
0,44&0,&0,&0,&s&0,\%&s&s&s&\\
\hline
\end{tabular}
\end{center}
\caption{$N_{rom}=5$}
%
\end{figure}

\subsubsection{One sphere and one cylinder : $\rho$ is the radius of the sphere}

\subsubsection{One sphere and one cylinder : $\rho$ is the radius of the cylinder}




