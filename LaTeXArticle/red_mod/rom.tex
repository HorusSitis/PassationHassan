%\section{A Reduced Order Model}
As we have seen in the previous section, computing solutions of equation \ref{chistr} for a given geometry, %
even, in the three-dimensional case, for an elementary cell with an euclidean bowl in its center.

\par
We notice that the geometry of some elementary cells, which is relevant for the calculus of the the homogenized tensor, %
depends of a real parameter, like the radius of a circular inclusion in the two-dimensional case, %
or the radius of a sphere or a cylinder for the third dimension.

\par
Those gemetrical parameters are also linked, in an obvious way, to the cells porosity which is a physical parameter - but not the only one , %
having an influence on diffusion in a porous medium.

\par
In this section we present a method for computing, with reasonable performances, good approximations of solutions of problem \ref{chistr}, %
and then homogenized diffusion tensors for a given set of cells depending on one real parameter, using a Reduced Order Model (ROM).

\etoile
This method relies on a Proper Orthogonal Decomposition (POD) : in a problem depending on a spatial variable $\mathbf{x}$ and a parameter $\tau$, %
which is often time, we write a decomposition of the general solution of a problem, typically a partial differential equation with boundary condition.

\par
If we write $w(\mathbf{x},\tau)$ the general solution of the spatial $\mathbf{x},\tau-$problem, typically Navier-Stokes equation or %\ref{} \cite{}
the Proper Orthogonal Decomposition is the following :

\begin{equation}\label{POD}
w(\mathbf{x},\tau)=\sum\limits_{i=1}^{N_{POD}} a_i(\tau)\phi_i(\mathbf{x})
\end{equation}

$N_{POD}$ is an integer lesser than the dimension of $H$ if this space is Euclidean, %
and $+\infty$ when $H$ is a separable Hilbert space.

\par
The above equality, will be true, at least in a good approximation, for an arbitrary parameter $\tau$.

\ligneinter
Every spatial function $w(\cdot,\tau)$ for a given $\tau$ is supposed to lie in an Hilbert space $H$, %
typically $\mathcal{L}^2$ of $H^1$ ; this space would also be euclidean, or generated by a Finite Element basis.

\par
Then $\phi_i$ are functions depending on $\mathbf{x}$ called \emph{spatial modes}, and form an orthogonal family in $H$. %
The coefficient $a_i(\tau)$ is the individual projection of $w(\cdot,\tau)$ in this basis, %
and the set $(a_i)_i$ will constitute the Reduced Order Model.

\ligneinter
Formally, if we have a given and a finite set $(w(\mathbf{x},\rho_j)$ of functions in $\mathbf{x}$ parametrized by a collection of real numbers $(\rho_j)$, %
coming from numerical simulations performed \og{} offline \fg{} or experimental results, we are looking for a vector basis of modes lying in %the subspace of 
$H$ %generated by the $w(\cdot,\rho_i)$ %
satisfying the conditions :

\begin{itemize}
\item $w(\mathbf{x},\tau_j)=\sum\limits_i a_i(\tau_j)\phi_n(\mathbf{x})$ for all $j$ and $\mathbf{x}$ ;
\item The $\Phi_j$ are orthogonal ;
\item $\phi_l= \arg\max\limits_{\phi_j\in H}\left\langle\left(\phi_j|\sum\limits_{k=1}^{l-1}\left(w|\phi_k\right)_H\phi_k\right)_H\right\rangle$ ; %
$\langle \ \rangle$ beeing the average operator over the $\tau_j-$s.
\end{itemize}

The last condition ensures that the POD base is optimal in the sense that for all $j$ smaller than the rank $N_{POD}$ of the basis $\Phi$, i. e. $(\phi_i)$, %
the average projection of the $w(\cdot , \tau_j)$ is maximal ; %
the space $[\phi_i]_{i=1}{l}$ gives the best approximation of $w(,)$ among the subspaces of $H$ with rank $l$.

\etoile
Finally, we will use the \ref{POD} and the equation \ref{chistr} to compute a vector $\chi(,\rho^{new})$ for an arbitrary parameter $\rho^{new}$, %
without the Finite Element Method.

\subsection{Proper Orthogonal Decomposition, snapshot method}

\subsubsection{The Fredholm Integral Equation}

We suppose we have a sample $w(\cdot,\tau_j)_j$ of spatial functions, which must be written in some POD base.

\par
The above optimisation problen in $(\phi_i)$ - we eventually write $\Phi$ for this base, %
can be formulated with lagrangian formalism, and is equivalent to the proper-value problem :

\begin{equation}\label{fred}
\int\limits_{\Omega}R(x,x')\phi_j (x)\text{d}x'=\lambda_j \phi_j (x)
\end{equation}

where :
\begin{itemize}
\item $\Omega$ is the space on which the functions $w(\cdot ,\tau_j)$, $\phi_i$ are defined ;
\item $\forall (x,x')\in\Omega^2 , R(x,x')=\left\langle(w(x,\tau)w(x',\tau)\right\rangle$ \emph{id est} $R(x,x')=\frac{1}{N_{\tau}}\sum\limits{j=1}^{N_t} w(x,\tau_j)w(x',\tau_j)$.
\end{itemize}

$R(x,x')_{x,x'}$, or $\mathcal{R}$, is the \emph{tensor of spatial correlations}. %
\ref{fred}, which is called Fredholm equation, can also be written :

\[\mathcal{R}\star_x\phi_i=\lambda_i\phi_i\text{ where $\star_x$ is the contracted product of $\mathcal{R}$ and $\phi_j$}\]

\etoile
When we do numerical calculus, the problem is formulated with a finite space $\Omega$, %
and the tensor $\mathcal{R}$ is a matrix of shape $N_x\times N_x$, $N_x :=|\Omega|$.

\par
The point is that, for practical purposes, $R(x,x')$ is a full-size matrix, with $N_x$ so large that the problem in $\lambda_i$ wouldn't be resolved ; %
this is the case in the problem of periodic homogenization.

\subsubsection{Snapshot method}

In this paragraph, we make some hypotheses :

\begin{enumerate}[label=(Snap \arabic*)]
\item\label{hs1} $N_{\tau}\ll N_x$ ;
\item The $w(\cdot , \tau_j)$ are linearly independent in $H$ ;
\item\label{hs3} For all $j$, $\phi_i(\mathbf{x})=\sum\limits_{j=1}^{N_{\tau}}\alpha_i(\tau_j) w(\mathbf{x},\tau_j)$.
\end{enumerate}

The spatial functions $w(\mathbf{x}, \tau_j)$ are called the \emph{snapshots}, a few of them should be enough to build a POD.

\par
Notice that the last hypothesis entails the POD basis contains a finite number $N_{POD}$ of vectors, and that $N_{POD}<N_t$.

\par
By construction, $\Phi$ depends on the data $w(\mathbf{x},\tau_j)$ and is'nt supposed to be universal, as can be the Fourier basis of a $\mathcal{L}^2$ space. %
Here, $\Phi$ is also supposed to be finite, and its cardinal is bounded by the size $N_{\tau}$ of the sample :

%\[\phi_i(\mathbf{x})=\sum\limits_{j=1}^{N_t}\alpha_i^j w(\mathbf{x},\tau_j)\]

Using Fubini theorem, Fredholm equation can be rewritten :

\begin{equation}\label{tenct}
\alpha_i\star_{\tau}\mathcal{C}\star_{\tau}w(\mathbf{x},\cdot)=\lambda_i\alpha_i\star_{\tau}(\mathbf{x},\cdot)
\end{equation}

where :
\begin{itemize}
\item $\mathcal{C}$ is the temporal-correlation tensor : $C(\tau,\tau ')=\dfrac{1}{N_{\tau}}\int w(\mathbf{y},\tau)w(\mathbf{y},\tau')\text{d}\mathbf{y}$ ;
\item $\star_{\tau}$ is the contracted product, with respect to the parameter $\tau$ : here, an integral on $\tau$ is a finite sum $\sum\limits{j=1}^{N_{\tau}}$.
\end{itemize}

Since \ref{hs1}, equation \ref{tenct} gives the following problem in $(\lambda_j , \alpha_j)$ :

\begin{equation}\label{tenct}
\mathcal{C}\star_{\tau}\alpha_i\mathbf=\lambda_i\alpha_i\star_{\tau} w(\mathbf{x},\cdot)
\end{equation}

which is analogous to the problem we found in the last paragraph.

\par
The matrix $C(\tau_j,\tau_j^{'})$ is symmetric positive. Solutions $\alpha_i$ of the problem are, by consequence, %
orthogonal. Formula \ref{hs3} gives :

\[{\alpha^{\ast}}_j^i\phi_i(\cdot )=w(\cdot ,\tau_j)\text{ where ${\alpha^{\ast}}_j^i=\alpha_i(\tau_j)$}\]

Since now we write : $\alpha^{\ast}==a$, we obtain the time-dependent coefficient we were looking for in POD :

\[w(\mathbf{x},\tau_j)=\sum\limits_{i=1}^{N_{POD}}a_i(\tau_j)\phi_i(\mathbf{x})\text{ for all $\mathbf{x}$}\]

with $a_i(\tau_j)$ given by : $a_i(\tau_j)=\alpha_i (\tau_j)$.

\ligneinter
Some characteristics of the method of snapshot given in this paragraph then are :

\begin{itemize}
\item The basis $\Phi$ we obtain has a small number of components, equal to $N_{\tau}$ ;
\item $\Phi$ lies in the space generated by the snapshots ;
\item $\Phi$ is orthogonal and $(\phi_n |\phi_m)=\lambda_m\delta_{mn}$ for all $m$ and $n$ :
\item $\Phi$ satisfies the optimality condition for the POD in the space generated by the $w(\cdot , \tau_j)$, but isn't supposed to be universal for functions in the general $H$ ;
\item With this method, we obtain the $\tau-$ dependent coefficients $a_i$ or $\alpha_i$, then the POD basis. 
\end{itemize}

\subsubsection{Choosing a first few modes of a POD basis}

As the $\Phi$ found for POD is orthogonal, we can consider the question of the energy contained in a subset of the basis. %
Indeed, optimality of $\Phi$ entails that a first few vectors of the POD basis contain substantial information on the entire vamily, %
and then of the parametrized set of functions $w(\cdot ,\tau)_{\tau}$ of our physical problem.

\par
The following algorithm is the method of snapshots, combined with the choice of a first few vectors of the optimal orthogonal basis. %
The latter provides us the Reduced-Order Model, which matters in the next paragraph.

\begin{algo}
\begin{enumerate}
\item Select a sample $w(\mathbf{x},\tau_j)$ of $\mathbf{x}$-dependent functions, %
they can be experimental measurements or numerical simulation ;
\item Compute the \og{}time-\fg{} correlation matrix $c(\tau_j ,\tau_{j'})$ ;
\item Find the proper values and vectors of $[C]$, which is supposed to be small ;
\item\label{so1} Sort the proper-values $\lambda_i$ in a decreasing order ;
\item Compute the $\phi_i$ using the proper vectors found for $[C]$ ;
\item\label{so2} Evaluate the energy contained in each mode : $Ener^i:=\dfrac{\sum\limits_{k=1}^i}{\sum\limits_{k=1}^{N_{POD}}}$ ;
\item Chhose the first $N$ for which $Ener^i >\nu$, where $\nu$ is the energy threshold we want - typically, $99\%$ ;
\item\label{so3} Compute the approximation error with the subset $(\phi_i)_{i=1}^{N}$.
\end{enumerate}
\end{algo}

The steps \ref{so1}, \ref{so2} and \ref{so3} have been added to the snapshot method. %
In practical purposes, $N$ will be small as a consequence of the optimality of $\Phi$. %
Thus, we obtain a decomposition that is not exact, but anyway very good, of our original sample with a \emph{reduced-order} orthogonal base.

\ligneinter
Let conclude that, when the function $w(\mathcal{x},\tau)$ satisfies a linear condition in $\mathbf{x}$, %
like a linear partial differential equation or a homogen boundary condition, %
we can push these functions in an Hilbert space which elements all satisfy the same relations, %
the preceeding reasonments then lead us to build a basis $\Phi$ whose vectors are solutions of the same problem.

\subsection{A Reduced Order Model (ROM)}

We have written a sample of functions of space $w$, parametrized with a finite set of the real number $\tau$ :

\begin{equation}
w(\mathbf{x},\tau)=\sum\limits_{i=1}^N a_i(\tau)\phi_i(\mathbf{x})
\end{equation}

The Reduced Order Model is the projection of the original problem on $w(\mathbf{x},\tau)$ along this decomposition.

\par
In this section, we define a ROM of the system \ref{chistr} using the so-called Galerkin projection on the basis $(\phi_i)$.

\etoile






